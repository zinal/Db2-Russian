****** Patroni

https://www.cybertec-postgresql.com/en/patroni-setting-up-a-highly-available-postgresql-cluster/

wget https://raw.githubusercontent.com/zalando/patroni/master/postgres0.yml

for x in 1 2 3; do ssh pgdemo"$x" firewall-cmd --add-port={5432,8008,7000,25432}/tcp --permanent; done
for x in 1 2 3; do ssh pgdemo"$x" firewall-cmd --reload; done

patroni pgdemo1.yaml > log_pgdemo1.log 2>&1 &
patroni pgdemo2.yaml > log_pgdemo2.log 2>&1 &
patroni pgdemo3.yaml > log_pgdemo3.log 2>&1 &

patronictl -d etcd://127.0.0.1:2379 list pgdemo

for x in 1 2 3; do ssh pgdemo"$x" setsebool -P haproxy_connect_any 1; done

for x in 1 2 3; do ssh pgdemo"$x" systemctl enable haproxy; done
for x in 1 2 3; do ssh pgdemo"$x" systemctl start haproxy; done

psql -p 25432 -h localhost -U admin -d template1
> create user pushkinn with encrypted password 'P@ssw0rd';
> grant pushkinn to admin;
> create database pushkinn with owner pushkinn;
> \c pushkinn
> create table tab1(a integer not null primary key, b varchar(100) not null);
> create table tab2(a integer not null primary key, b varchar(100) not null);
> create table tab3(a integer not null primary key, b varchar(100) not null);

